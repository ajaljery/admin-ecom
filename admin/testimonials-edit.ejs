<%- include('./partials/header') %>
<div class="wrapper">
    <%- include('./partials/sidebar') %>
    <%- include('./partials/adminHeader') %>

    <div class="page-content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <div class="settings-panel">
                        <form action="/admin/site-settings/testimonials/add" method="POST">
                            <div class="settings-section">
                                <div class="section-header">
                                    <h3>Add New Testimonial</h3>
                                    <p>Enter the details of a new customer review to display on your site.</p>
                                </div>
                                <div class="section-body">
                                    <div class="form-grid">
                                        <div class="form-group">
                                            <label for="client-name">Client Name</label>
                                            <input type="text" id="client-name" name="clientName" class="form-control" placeholder="e.g., Anjali K." required>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="client-review">Review Text</label>
                                        <textarea id="client-review" name="reviewText" class="form-control" rows="4" placeholder="Enter the customer's review here..." required></textarea>
                                    </div>
                                </div>
                                <div class="section-footer">
                                    <button type="submit" class="btn btn-primary">Add Testimonial</button>
                                </div>
                            </div>
                        </form>

                        <div class="settings-section">
                            <div class="section-header">
                                <h3>Existing Testimonials</h3>
                                <p>Manage the reviews currently displayed on your site.</p>
                            </div>
                            <div class="section-body">
                                <div class="testimonials-list-grid">
                                    <%# Sample data structure for demonstration %>
                                    <% const testimonials = [
                                        { _id: '1', clientName: 'Priya S.', reviewText: 'The amethyst bracelet is absolutely stunning and I can feel such a calming energy from it. The quality is incredible!' },
                                        { _id: '2', clientName: 'Rohan V.', reviewText: 'Excellent customer service and the products are even more beautiful in person. Highly recommended.' }
                                    ]; %>

                                    <% if (testimonials && testimonials.length > 0) { %>
                                        <% testimonials.forEach(testimonial => { %>
                                            <div class="testimonial-card">
                                                <div class="testimonial-card-header">
                                                    <i class="fas fa-quote-left quote-icon"></i>
                                                    <form action="/admin/site-settings/testimonials/delete" method="POST" onsubmit="return confirm('Are you sure you want to delete this testimonial?');">
                                                        <input type="hidden" name="testimonialId" value="<%= testimonial._id %>">
                                                        <button type="submit" class="delete-btn" title="Delete Testimonial">
                                                            <i class="fas fa-trash-alt"></i>
                                                        </button>
                                                    </form>
                                                </div>
                                                <p class="testimonial-text">"<%= testimonial.reviewText %>"</p>
                                                <strong class="client-name">- <%= testimonial.clientName %></strong>
                                            </div>
                                        <% }) %>
                                    <% } else { %>
                                        <div class="empty-state">
                                            <i class="fas fa-comment-slash"></i>
                                            <h4>No Testimonials Found</h4>
                                            <p>Use the form above to add your first customer testimonial.</p>
                                        </div>
                                    <% } %>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<%- include('./partials/footer') %>

<style>
    :root {
        --primary-color: #4f46e5;
        --primary-hover-color: #4338ca;
        --danger-color: #ef4444;
        --danger-hover-color: #dc2626;
        --border-color: #e5e7eb;
        --card-background-color: #ffffff;
        --text-primary: #111827;
        --text-secondary: #6b7280;
        --input-border: #d1d5db;
        --panel-background: #f9fafb;
    }

    .page-content {
        padding: 1.5rem;
    }

    .settings-panel {
        background: var(--card-background-color);
        border: 1px solid var(--border-color);
        border-radius: 0.75rem;
        box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
        overflow: hidden;
    }

    .settings-section {
        /* No padding here, moved to children */
    }
    form:not(:last-child) .settings-section {
        border-bottom: 1px solid var(--border-color);
    }

    .section-header {
        padding: 1.5rem 2rem 0 2rem;
    }
    .section-header h3 {
        font-size: 1.25rem;
        font-weight: 600;
        margin: 0;
        color: var(--text-primary);
    }
    .section-header p {
        margin: 0.25rem 0 0;
        color: var(--text-secondary);
        font-size: 0.875rem;
    }
    .section-body {
        margin-top: 1.5rem;
        padding: 0 2rem;
    }
    .settings-section:last-child .section-body {
        padding-bottom: 1.5rem;
    }

    /* Form Styles */
    .form-group { margin-bottom: 1.25rem; }
    .form-group label { font-weight: 500; display: block; margin-bottom: 0.5rem; color: #374151; font-size: 0.875rem; }
    .form-control { width: 100%; padding: 0.75rem 1rem; border: 1px solid var(--input-border); border-radius: 0.5rem; font-size: 1rem; transition: border-color 0.2s, box-shadow 0.2s; }
    .form-control:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.2); }
    textarea.form-control { resize: vertical; }

    /* Testimonial Cards */
    .testimonials-list-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1.5rem;
    }
    .testimonial-card {
        background-color: var(--panel-background);
        border: 1px solid var(--border-color);
        border-radius: 0.75rem;
        padding: 1.25rem;
        display: flex;
        flex-direction: column;
    }
    .testimonial-card-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 0.75rem;
    }
    .quote-icon {
        font-size: 1.75rem;
        color: var(--primary-color);
        opacity: 0.5;
    }
    .testimonial-text {
        font-family: Georgia, serif;
        font-style: italic;
        color: var(--text-primary);
        line-height: 1.6;
        flex-grow: 1;
        margin: 0;
    }
    .client-name {
        font-weight: 600;
        color: var(--text-secondary);
        margin-top: 1rem;
        text-align: right;
    }
    .delete-btn {
        background: none;
        border: none;
        color: var(--text-secondary);
        cursor: pointer;
        padding: 0.25rem;
        font-size: 0.9rem;
        transition: color 0.2s;
    }
    .delete-btn:hover {
        color: var(--danger-color);
    }

    /* Empty State */
    .empty-state {
        grid-column: 1 / -1; /* Span full width */
        text-align: center;
        padding: 3rem 1rem;
        border: 2px dashed var(--border-color);
        border-radius: 0.75rem;
        color: var(--text-secondary);
    }
    .empty-state i {
        font-size: 2.5rem;
        margin-bottom: 1rem;
        opacity: 0.6;
    }
    .empty-state h4 {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--text-primary);
        margin: 0;
    }
    .empty-state p {
        margin-top: 0.5rem;
    }

    /* Section Footer */
    .section-footer {
        padding: 1.5rem 2rem;
        text-align: right;
        background-color: var(--panel-background);
        margin: 1.5rem -2rem 0 -2rem;
        border-top: 1px solid var(--border-color);
    }
    .btn { padding: 0.625rem 1.5rem; border-radius: 0.5rem; font-weight: 600; cursor: pointer; border: none; font-size: 0.9rem; }
    .btn-primary { background: var(--primary-color); color: white; transition: background-color 0.2s; }
    .btn-primary:hover { background: var(--primary-hover-color); }
</style>